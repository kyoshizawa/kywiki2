
# 一時退避

### 業務アプリ側の変更

| アプリ | 変更内容 |
|--------|---------|
| AP02 CAFIS業務処理サービス | 接続先を AP03→Routing Engine(Port 7000) に変更 |
| AP22 CARDNET業務サービス | 接続先を FEXICS→Routing Engine(Port 5000) に変更 |

### コンポーネント仕様

#### Routing Engine

| 項目 | 仕様 |
|------|------|
| 役割 | 電文解析、接続コードによるGateway振り分け |
| 実行環境 | Amazon ECS on EC2 |
| 待ち受けPort | 7000（CAFIS系）, 5000（CARDNET系） |
| スケール | 水平スケール可（ステートレス） |

**機能**:
- 電文ヘッダ解析（接続コード判定）
- ルーティングテーブルに基づくGateway選択
- Gateway障害時のフェイルオーバー

#### Gateway Service

| 項目 | 仕様 |
|------|------|
| 役割 | 電文変換、接続管理 |
| 実行環境 | Amazon ECS on EC2 |
| 待ち受けPort（外部向け） | 2010（CAFIS）, 2200（CARDNET） |
| 動作モード | **常時Listen**（CAFIS/CARDNETからの接続を受付） |
| スケール | **回線単位**（回線追加時にサーバー追加） |

**機能**:
- 電文フォーマット変換（業務アプリ ↔ CAFIS/CARDNET）
- CAFIS/CARDNETからの接続受付・維持
- A1/A2系切替、タイムアウト、リトライ
- 通信ログ出力（PCI DSS対応）



### 言語選定

| 候補 | フレームワーク | サポート期限 | 備考 |
|------|---------------|-------------|------|
| **C# (.NET 10)** | ASP.NET Core | 2028年11月（LTS） | 既存Windows環境との親和性 |

**Note:**
```
■ 比較材料
C# (.NET 10)  移行作業は軽め　PCI環境で使用言語の統一ができる
Kotlin        EOLがやや長い
```