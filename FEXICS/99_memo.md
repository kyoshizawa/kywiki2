## 考慮メモ

### ISO8583
- 標準仕様としてどこまで入っている？


### CAFIS or CARDNET

### 暗号化

## .net 10

### 設定項目

KEK : Cardnet はこれを設定する。こういった決済ネットワークが発行する設定は外部から入れられるようにしたほうが。


### 実装したい機能のメモ
- 顧客単位での切り替え
- AP22 が FEXICS 直利用のため、クライアントコードをかませる必要ある。   
  それなら AP02 もクライアントコードを入れ替えてもいいかも。  

- シミュレータ機能（開発環境）

- ジャーナル確認できる機能
- 性能状況の観測ができる機能

### 思いつく機能
- TCP Listen
- 開局 / 閉局
- ステータス確認
- 経路制御
- 日次更新（たぶんFEXICS都合なのでこれはいらないかも）
- オーソリ
- オーソリ取消
- アドバイス
- 障害取消
- iD のみ
  - アクセスキーDL
- 銀聯（対象外？
- リカバリ

その他、伝送試験仕様をみて、必要なものを確認する必要がある。

CAFIS × CARDNET

### ？
- 仕向け先は新アプリが決める？
　 Routing Engine のやること？
- docker 使う？ 方法は？
- DBもつ？
- Kotlin？
- 平行稼働のやりかた？（CAFIS から繋ぎにくる）
- 通知方法（ログ？）
- Routing と Gateway 間のプロトコル

### DBもつなら
- PCI 要件での暗号化保存

### 他
- ログ収集はインフラと確認

### ロードマップ
[CAFIS]
- 開発サーバ置き換え
- ブランド試験サーバ確認
- 本番リリース

[CARDNET]
- 〃



## claude 提案 考慮事項

  可用性・障害対策                                                                                                                                      
  - フェイルオーバー戦略 - Active-Active 2台構成でのセッション引き継ぎ方法                                                                           
  - ヘルスチェック - CAFIS/CARDNET 側からの死活監視への応答
  - タイムアウト設計 - 各処理段階でのタイムアウト値と挙動
  - リトライ戦略 - 通信エラー時の再試行ポリシー
  - サーキットブレーカー - 連続障害時の縮退運転

  セキュリティ（PCI DSS 関連）

  - 通信暗号化 - TLS バージョン、証明書管理
  - 監査ログ - アクセス記録、改ざん検知
  - 鍵管理 - 暗号鍵のローテーション、保管方法
  - ネットワーク分離 - セグメント設計

  運用

  - 設定管理 - 環境別設定の切り替え方法
  - デプロイ戦略 - 無停止デプロイの方法
  - ロールバック手順 - 切り戻し方法と判断基準
  - 監視・アラート - 閾値設定、通知先

  パフォーマンス要件

  - スループット - 秒間トランザクション数の目標値
  - レイテンシ - 許容応答時間
  - コネクション管理 - プーリング、最大接続数

  テスト

  - 結合テスト環境 - CAFIS/CARDNET との接続試験方法
  - 負荷テスト - ピーク時想定の検証方法
  - 障害注入テスト - 異常系の検証

  移行時の整合性

  - トランザクション整合性 - 切り替え時の処理中電文の扱い
  - 切り戻し判断基準 - どの指標で判断するか

  これらの中で優先度が高いもの、または深掘りしたい項目はありますか？