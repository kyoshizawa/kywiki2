# 第3章　機能仕様

## 3.1　電文仕様

### 3.1.1　電文種別

CAFISで使用する制御電文、および障害電文の電文種別一覧を表3.1.1-1に示す。


【表 3.1.1-1　電文種別一覧（1/2）】

| 項番 | 電文区分 | 電文種別 | 電文名 | 備考 |
|---|---|---|---|---|
| 1 | 制御電文 | 0010 | 開始指令 | |
| 2 | 制御電文 | 0120 | 開始準備完了報告 | |
| 3 | 制御電文 | 7020 | 再開始要求 | |
| 4 | 制御電文 | 7110 | 再開始許可指令 | |
| 5 | 制御電文 | 0610 | 終了予告指令 | |
| 6 | 制御電文 | 0620 | 終了準備完了報告 | |
| 7 | 制御電文 | 0720 | 終了要求 | |
| 8 | 制御電文 | 0810 | 終了許可指令 | |
| 9 | 制御電文 | 0910 | 終了指令 | |
| 10 | 制御電文 | 0920 | 終了報告 | |
| 11 | 制御電文 | 9210 | 回線障害回復指令 | |
| 12 | 制御電文 | 9220 | 回線障害回復報告 | |
| 13 | 障害電文 | 8910 | 取消指令 | |
| 14 | 障害電文 | 8920 | 取消再指令 | |
| 15 | 障害電文 | 8930 | 取消確認指令 | |
| 16 | 障害電文 | 8940 | 取消確認再指令 | |
| 17 | 障害電文 | 8950 | 取消報告 | |
| 18 | 障害電文 | 8960 | 取消確認報告 | |
| 19 | 障害電文 | 8970 | 異常報告 | |

【表 3.1.1-1　電文種別一覧（2/2）】

| 項番 | 電文区分 | 電文種別 | 電文名 | 備考 |
|---|---|---|---|---|
| 20 | 一般電文 | 3510 | その他要求 | |
| 21 | 一般電文 | 3520 | その他許可報告 | |
| 22 | 一般電文 | 4110 | カウント通知 | |
| 23 | 一般電文 | 4120 | カウント完了報告 | |
| 24 | 一般電文 | 4910 | カウント異常要求 | |
| 25 | 一般電文 | 4920 | カウント異常報告 | |
| 26 | 一般電文 | 8970 | 異常報告 | |

（注）他の一般電文については、各個別業務編で記述する。

## 3.1.2　電文処理形態

制御電文処理形態を表3.1.2-1に、一般電文処理形態を表3.1.2-2に、障害電文処理形態を表3.1.2-3に示す。


【表 3.1.2-1　制御電文処理形態】

| 処理 | 電文種別 | 通信方向 | 発生条件 |
|---|---|---|---|
| 開始処理 | 開始指令 | CAFIS→貴社センタ | CAFISセンタから貴社センタにサービス開始を指示する場合 |
|  | 開始準備完了報告 | 貴社センタ→CAFIS | 貴社センタがサービス開始準備完了の場合 |
|  | 再開始要求 | 貴社センタ→CAFIS | 貴社センタが障害復旧した場合又は再開始する場合 |
|  | 再開始許可指令 | CAFIS→貴社センタ | CAFISセンタから貴社センタに再開始の許可を指示する場合 |
| 終了処理 | 終了予告指令 | CAFIS→貴社センタ | CAFISセンタから貴社センタにサービス終了を指示する場合 |
|  | 終了準備完了報告 | 貴社センタ→CAFIS | 貴社センタがサービス終了準備完了の場合 |
|  | 終了指令 | CAFIS→貴社センタ | CAFISセンタから貴社センタにサービス終了を指示する場合 |
|  | 終了報告 | 貴社センタ→CAFIS | 貴社センタがサービスを終了した場合 |
|  | 終了要求 | 貴社センタ→CAFIS | 貴社センタがサービスを終了したい場合 |
|  | 終了許可指令 | CAFIS→貴社センタ | CAFISセンタから貴社センタにサービス終了の許可を指示する場合 |
| 障害処理 | 回線障害回復指令 | CAFIS→貴社センタ | 貴社センタの回線障害の回復を確認する場合 |
|  | 回線障害回復報告 | 貴社センタ→CAFIS | 回線障害回復報告を送信した場合 |
|  | 回線障害回復指令 | CAFIS→貴社センタ | CAFISセンタ側の回線障害の回復を確認する場合 |
|  | 回線障害回復報告 | 貴社センタ→CAFIS | 回線障害回復報告を受信した場合 |

【表 3.1.2-2　一般電文処理形態（1/3）】

| 処理 | 電文種別 | 通信方向 | 発生条件 |
|---|---|---|---|
| 一般処理 | ××要求 | 端末→CAFIS | ××業務の取扱を依頼する場合 |
|  | ××要求 | CAFIS→被仕向センタ | ××要求を中継する場合 |
|  | ××許可報告 | 被仕向センタ→CAFIS | 被仕向センタで××業務の取扱を許可した場合 |
|  | ××許可報告 | CAFIS→端末 | CAFISセンタが××許可の通知を中継する場合 |
|  | ××拒否報告 | 被仕向センタ→CAFIS | 被仕向センタで××業務の取扱を拒否した場合 |
|  | ××拒否報告 | CAFIS→端末 | CAFISセンタが××拒否の通知を中継する場合 |
| 障害処理 | 障害報告 | CAFIS→端末 | ××要求電文を貴社センタ障害等で送信不能となった場合 |
|  | 障害報告 | CAFIS→被仕向センタ | ××要求電文を貴社センタ障害等で送信不能となった場合 |

【表 3.1.2-2　一般電文処理形態（2/3）】

| 処理 | 電文種別 | 通信方向 | 発生条件 |
|---|---|---|---|
| 一般処理 | ××要求 | 仕向センタ→CAFIS | ××業務の取扱を依頼する場合 |
|  | ××要求 | CAFIS→被仕向センタ | ××要求を中継する場合 |
|  | 異常報告 | CAFIS→仕向センタ | 被仕向センタへの送信不能の場合、又は送信したが応答を受信できなかった場合 |
|  | ××許可報告 | 被仕向センタ→CAFIS | 被仕向センタで××業務の取扱を許可した場合 |
|  | ××許可報告 | CAFIS→仕向センタ | CAFISセンタが××許可の通知を中継する場合 |
|  | ××拒否報告 | 被仕向センタ→CAFIS | 被仕向センタで××業務の取扱を拒否した場合 |
|  | ××拒否報告 | CAFIS→仕向センタ | CAFISセンタが××拒否の通知を中継する場合 |
| 一般処理 | その他要求 | CAFIS→被仕向センタ | CAFISセンタが折返し処理を行う場合 |
|  | その他許可報告 | 被仕向センタ→CAFIS | その他要求を受信した場合 |
|  | 異常報告 | CAFIS→仕向センタ | CAFISセンタで電文異常が発生した場合 |

（注）CAFIS折返しの電文送信不能及びタイムアウトの場合は、障害電文を送信してはならない。

【表 3.1.2-2 一般電文処理形態（3/3）】

| 処理 | 電文種別 | 通信方向 | 発生条件 |
|------|----------|----------|----------|
| 一般処理（カウンタ通知） | カウンタ通知 | 仕向センタ → CAFISセンタ → 被仕向センタ | 仕向センタより「終了要求」または「終了準備完了報告」を受信し、仕向中処理を行った場合 |
|  | カウンタ完了報告 | 被仕向センタ → CAFISセンタ → 仕向センタ | カウンタ通知を受信した場合 |
| 一般処理（カウンタ解除） | カウンタ解除要求 | 仕向センタ → CAFISセンタ → 被仕向センタ | 仕向センタより解除要求があった場合 |
|  | カウンタ解除報告 | 被仕向センタ → CAFISセンタ → 仕向センタ | 解除要求が許可された場合 |
|  | 異常報告 | 被仕向センタ → CAFISセンタ → 仕向センタ | CAFISセンタで電文異常が発生した場合 |

---

**注：**

送信異常およびタイムアウト等による電文の取扱いは以下とする。  
CAFIS折返しの電文の送信不能およびタイムアウトの場合は、障害電文を送信してはならない。


【表 3.1.2-3　障害電文処理形態（1/5）】

| 処理 | 電文種別 | 通信方向（仕向センタ → CAFISセンタ → 被仕向センタ） | 発生条件 |
|------|----------|-----------------------------------------------|----------|
| 取消処理 | 取消指令 | 仕向 → CAFIS → 被仕向 | 端末からの「××要求」に対する応答を被仕向センタに要求した業務処理電文の応答電文が未着の場合 |
|  | 取消報告 | 被仕向 → CAFIS → 仕向 | CAFISセンタから「取消指令」を受信した場合 |
| 取消確認処理 | 取消確認指令 | 仕向 → CAFIS → 被仕向 | 端末からの「××要求」電文を被仕向センタに送信したが応答電文を受信できなかった場合 |
|  | 取消確認報告 | 被仕向 → CAFIS → 仕向 | CAFISセンタから「取消確認指令」を受信した場合 |
| 取消再処理 | 取消再指令 | CAFIS → 被仕向 | CAFISセンタより「取消（再）指令」を送信後、CAFISセンタ又は被仕向センタが障害で応答電文を受信できなかった場合、又はCAFISセンタより「取消（再）指令」を送信したが応答がない場合 |
|  | 取消報告 | 被仕向 → CAFIS | CAFISセンタより「取消再指令」を受信した場合 |
| 取消確認再処理 | 取消確認再指令 | CAFIS → 被仕向 | CAFISセンタより「取消確認（再）指令」を送信したが、CAFISセンタ又は被仕向センタが障害で応答電文を受信できず、その後復旧した場合、又はCAFISセンタより「取消確認（再）指令」を送信したが応答がない場合 |
|  | 取消確認再報告 | 被仕向 → CAFIS | CAFISセンタより「取消確認再指令」を受信した場合 |

【表 3.1.2-3 障害電文処理形態（2/5）】

| 処理 | 電文種別 | 通信方向（仕向センタ → CAFISセンタ → 被仕向センタ） | 発生条件 |
|------|----------|-----------------------------------------------|----------|
| 取消処理 | 取消指令 | 仕向 → CAFIS → 被仕向 | ××業務電文は××拒否電報をCAFISセンタより受信後に業務通信でセンタから被仕向センタに送信した場合 |
|  | 取消報告 | 被仕向 → CAFIS → 仕向 | 被仕向センタへ送信後、報告を受信できなかった場合又は送信不可等で障害発生した場合に業務電文を送信する必要がない場合 |
|  | 異常報告 | 被仕向 → CAFIS → 仕向 | 被仕向センタが送信不可等で、再度仕向センタに業務電文を送信する必要がある場合 |
|  | 取消指令 | CAFIS → 被仕向 | 仕向センタから「取消指令」を受信した場合 |
|  | 取消報告 | 被仕向 → CAFIS | 被仕向センタがCAFISセンタから「取消指令」を受信した場合 |
|  | 取消報告 | 被仕向 → CAFIS | 被仕向センタから「取消報告」を受信した場合 |
| 取消処理（CAFIS） | 取消指令 | CAFIS → 被仕向 | 被仕向センタに「取消指令」が送信不可の場合で、その後被仕向センタが再開した場合又は仕向センタに「××要求」の報告が送信された場合 |
|  | 取消報告 | 被仕向 → CAFIS | CAFISセンタから「取消指令」を受信した場合 |


【表 3.1.2-3 障害電文処理形態（3/5）】

| 処理 | 電文種別 | 通信方向（仕向センタ → CAFISセンタ → 被仕向センタ） | 発生条件 |
|------|----------|-----------------------------------------------|----------|
| 取消確認処理 | 取消確認指令 | 仕向 → CAFIS → 被仕向 | 「××要求」に対する報告をCAFISセンタより受信できない場合 |
| | 取消確認報告 | 被仕向 → CAFIS → 仕向 | すでに被仕向側に対して取消が完了している場合 |
| | 異常報告 | 被仕向 → CAFIS → 仕向 | 被仕向センタへ送信不可の場合に再度仕向センタより業務電文を送信する必要がある場合、当該「××要求」を直前に受信していない場合 |
| | 取消指令 | CAFIS → 被仕向 | 仕向センタから取消確認指令電文を受信した場合で「××要求」の着信がない場合 |
| | 取消報告 | 被仕向 → CAFIS | CAFISセンタから「取消指令」を受信した場合 |
| | 取消確認報告 | 被仕向 → CAFIS | 被仕向センタから「取消報告」を受信した場合 |
| 取消確認処理（CAFIS） | 取消確認指令 | CAFIS → 被仕向 | 被仕向センタに「××要求」を送信したが応答がない場合又は取消確認指令電文が送信不可の場合で被仕向センタがその後再開した場合 |
| | 取消確認報告 | 被仕向 → CAFIS | CAFISセンタから「取消確認指令」を受信した場合 |


【表 3.1.2-3 障害電文処理形態（4/5）】

| 処理 | 電文種別 | 通信方向（仕向センタ → CAFISセンタ → 被仕向センタ） | 発生条件 |
|------|----------|-----------------------------------------------|----------|
| 取消再処理 | 取消再指令 | CAFIS → 被仕向 | 被仕向センタに「取消確認指令」又は「取消確認再指令」を送信したが応答がない場合 |
| | 取消報告 | 被仕向 → CAFIS → 仕向 | すでに被仕向センタの取消が完了している場合 |
| | 異常報告 | 被仕向 → CAFIS → 仕向 | 被仕向センタへ送信不可の場合に再度仕向センタより業務電文を送信する必要がある場合 |
| | 取消指令 | CAFIS → 被仕向 | 被仕向センタの取消が完了していない場合 |
| | 取消報告 | 被仕向 → CAFIS | CAFISセンタから「取消指令」を受信した場合 |
| | 取消報告 | 被仕向 → CAFIS | 被仕向センタから「取消報告」を受信した場合 |
| 取消再処理（CAFIS） | 取消再指令 | CAFIS → 被仕向 | 被仕向センタに「取消確認指令」又は「取消確認再指令」を送信したが応答がない場合で被仕向センタがその後再開した場合 |
| | 取消報告 | 被仕向 → CAFIS | CAFISセンタから「取消確認再指令」を受信した場合 |

【表 3.1.2-3 障害電文処理形態（5/5）】

| 処理 | 電文種別 | 通信方向（仕向センタ → CAFISセンタ → 被仕向センタ） | 発生条件 |
|------|----------|-----------------------------------------------|----------|
| 取消確認再処理 | 取消確認再指令 | CAFIS → 被仕向 | 被仕向センタに「取消確認指令」又は「取消確認再指令」を送信したが応答がない場合 |
|  | 取消確認報告 | 被仕向 → CAFIS → 仕向 | すでに被仕向センタの取消が完了している場合 |
|  | 異常報告 | 被仕向 → CAFIS → 仕向 | 被仕向センタへ送信不可の場合に再度仕向センタより業務電文を送信する必要がある場合 |
|  | 取消指令 | CAFIS → 被仕向 | 被仕向センタの取消が完了していない場合 |
|  | 取消報告 | 被仕向 → CAFIS | CAFISセンタから「取消指令」を受信した場合 |
|  | 取消確認報告 | 被仕向 → CAFIS | 被仕向センタから「取消報告」を受信した場合 |
| 取消確認再処理（CAFIS） | 取消確認再指令 | CAFIS → 被仕向 | 被仕向センタに「取消確認指令」又は「取消確認再指令」を送信したが応答がない場合で被仕向センタがその後再開した場合 |
|  | 取消確認報告 | 被仕向 → CAFIS | CAFISセンタから「取消確認再指令」を受信した場合 |

### 3.1.3 電文構成

CAFISセンタと被仕向センタ間で使用する電文構成一覧表（制御電文）を表3.1.3-1に、電文構成一覧表（一般電文）を表3.1.3-2に示す。

【表 3.1.3-1 電文構成一覧表（制御電文）】

| 項番 | 電文種別 | コード | 電文名 | 長さ | 共通ヘッダ部 | 備考 |
|------|----------|--------|--------|------|--------------|------|
| 1 | 制御 | 0010 | 開始指令 | 63 | ① | |
|  |  | 0120 | 開始準備完了報告 | 63 | ① | |
|  |  | 7020 | 再開始要求 | 63 | ① | |
|  |  | 7110 | 再開始許可指令 | 63 | ① | |
|  |  | 0610 | 終了指令 | 63 | ① | |
|  |  | 0620 | 終了準備完了報告 | 63 | ① | |
|  |  | 0720 | 終了要求 | 63 | ① | |
|  |  | 0810 | 終了許可指令 | 63 | ① | |
|  |  | 0910 | 終了指令 | 63 | ① | |
|  |  | 0920 | 終了報告 | 63 | ① | |
|  |  | 9210 | 回線障害回復確認指令 | 63 | ① | |
|  |  | 9220 | 回線障害回復報告 | 63 | ① | |

【表 3.1.3-2 電文構成一覧表（一般電文）】

| 項番 | 電文種別 | コード | 電文名 | 長さ | 共通ヘッダ部 | データ部1-0 | データ部1-4 | 備考 |
|------|----------|--------|--------|------|--------------|-------------|-------------|------|
| 1 | その他 | 3510 | その他要求 | 114 | ① | ② | ③ | CAFIS拡張セグメント |
|  |  | 3520 | その他許可報告 | 114 | ① | ② | ③ | |
|  |  | 8970 | 異常報告 | 114 | ① | ② | ③ | |
| 2 | カウンタ照会 | 4910 | カウンタ照会要求 | 110 | ① | ② |  | CAFIS拡張 |
|  |  | 4920 | カウンタ照会報告 | max324 | ① | ② |  | |
|  |  | 8970 | 異常報告 | 110 | ① | ② |  | |
| 3 | カウンタ通知 | 4110 | カウンタ通知 | max324 | ① |  | ② | |
|  |  | 4120 | カウンタ完了報告 | max324 | ① |  | ② | |

### 3.1.4 電文構成

CAFISセンタが、端末および被仕向センタ間で使用する電文構成を、以下に説明する。

(1) 基本電文構成  
基本電文構成を表3.1.4-1に示す。


【表 3.1.4-1 基本電文構成（1/2）】

| 項番 | 送信方向 | 電文区分 | 電文構成 |
|------|----------|----------|----------|
| 1 | 端末 → CAFISセンタ | 一般電文 | 業務共通ヘッダ部（47桁）＋各種データ部（可変長 max246桁） |
| 2 | | 一般電文 | データ部1-0-1（47桁）＋各種データ部（可変長 max208桁） |
| 3 | CAFISセンタ → 被仕向センタ | 制御電文 | 共通制御ヘッダ部（63桁） |
| 4 |  | 一般電文（業務電文） | 共通制御ヘッダ部（63桁）＋各種データ部（可変長 max666桁） |
| 5 |  | 一般電文 | 共通制御ヘッダ部（63桁）＋業務共通ヘッダ部（47桁）＋各種データ部（可変長 max245桁） |
| 6 |  | 一般電文 | 共通制御ヘッダ部（63桁）＋データ部1-0-1（47桁）＋各種データ部（可変長 max208桁） |

【表 3.1.4-1 基本電文構成（2/2）】

| 項番 | 送信方向 | 電文区分 | 電文構成 |
|------|----------|----------|----------|
| 7 | 被仕向センタ → CAFISセンタ | 制御電文 | 共通制御ヘッダ部（63桁） |
| 8 |  | 一般電文 | 共通制御ヘッダ部（63桁）＋各種データ部（可変長 max700桁） |
| 9 |  | 一般電文 | 共通制御ヘッダ部（63桁）＋データ部1-0-1（47桁）＋各種データ部（可変長 max208桁） |
| 10 |  | 障害電文 | 共通制御ヘッダ部（63桁） |
| 11 |  | 障害電文 | 共通制御ヘッダ部（63桁）＋各種データ部（可変長 max256桁） |
| 12 |  | 障害電文 | 共通制御ヘッダ部（63桁）＋データ部1-0-1（47桁）＋各種データ部（可変長 max208桁） |
| 13 | CAFISセンタ → 端末 | 一般電文 | 各種データ部（可変長 max700桁）※DLL電文を除く |

(2) 電文内容

① 共通制御ヘッダ部  
CAFISセンタと被仕向センタ間の電文で、電文種別等の共通的な項目を設定する。  
共通制御ヘッダ部のフォーマットを図3.1.4-1に、共通制御ヘッダ部の各項目説明を表3.1.4-1に示す。  

② データ部1-4  
データ部1-4のフォーマットを図3.1.4-2に、データ部1-4の項目説明を表3.1.4-2に示す。  

③ データ部E  
データ部Eのフォーマットを図3.1.4-3および図3.1.4-4に、データ部Eの項目説明を表3.1.4-3および表3.1.4-4に示す。  

④ その他のデータ部  
各業務の機能仕様書を参照すること。  


【図 3.1.4-1 共通制御ヘッダ部のフォーマット】

| 項目名 | 桁数 |
|--------|------|
| 経路番号 | 4 |
| 仕向処理通番 | 6 |
| センタ識別番号 | 2 |
| 回線番号 | 3 |
| CAFIS処理通番 | 6 |
| 仕向会社コード | 7 |
| 仕向サブコード | 4 |
| 被仕向会社コード | 7 |
| 被仕向サブコード | 4 |
| 電文種別 | 4 |
| CAFIS処理日 | 4 |
| CAT送信状態表示 | 1 |
| 仕向処理日付 | 2 |
| 代行電文報告表示 | 2 |
| 代行電文エラー表示 | 3 |
| 代行祭祀向け表示 | 1 |
| トレーラレングス | 3 |
