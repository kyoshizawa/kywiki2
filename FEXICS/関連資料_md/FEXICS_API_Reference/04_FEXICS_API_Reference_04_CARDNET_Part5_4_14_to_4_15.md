# 4.14. 精査不整合の原因となる電文判別

FEXICS では、API のリターンコードによって取るべき対応を判別できるようになっています。  
次項に記述されている `FX_SendAuth()` / `FX_SendAndCaptureAuth()` のリターンコードは、下記の分類となります。

---

## 精査不整合の発生しないリターンコード

| リターンコード | 内容 |
|---|---|
| RC_OK | 承認されました。 |
| RC_NG | 拒否されました（通常の拒否応答）。 |
| RC_REFER_TO_ISSUER | 拒否。ISSUER からカード会社への問い合わせを指示されました。 |
| RC_PK | 拒否。ISSUER からカードの回収を指示されました。 |
| RC_NO_SESSION_ID | 指定したセッション ID が無効です。 |
| RC_USE_SESSION_ID | 指定されたセッション ID は、他の API で使用されています。 |
| RC_INVALID_PARAM | 引数の数が不正、または無効な値があります。 |
| RC_PKG_IS_SIGNOFF_OR_SWITCHING | サインオフ状態、または状態遷移中のため電文を送信、または受信できません。 |
| RC_ERR_ALL_CENTER_SESSION | 決済センターと FEXICS Daemon 間のセッションがすべて切断されています。 |

これらのリターンコードは、  
- クレジット決済センターからの応答電文から導き出されたもの  
- もしくは、電文の送信自体が行われていないもの  

であるため、クレジット接続センターと FEXICS Daemon 間（および API をコールするアプリケーション）での取引結果の認識は一致しています。  
したがって、これらのリターンコードを受け取った取引については、**精査不整合は発生しません**。

---

## 精査不整合の疑いのあるリターンコード

| リターンコード | 内容 |
|---|---|
| RC_TIME_OUT | タイムアウトが発生しました。 |
| RC_ERROR_API_INTERNAL | API 内部にて、システムまたはプログラムのエラーが発生しました。 |
| RC_ERROR_DAEMON | Daemon 内部にて、システムまたはプログラムのエラーが発生しました。 |
| RC_ERROR_SOCKET | FEXICS Daemon との接続が切断されました。当該セッションをクローズしてください。 |
| RC_ERROR_CENTER | Center から受信した電文が不正です。 |

これらのリターンコードは、**接続センターへの電文送信後に、FEXICS Daemon の判断でセットされたもの**です。  
そのため、クレジット決済センターとの間で **精査不整合を発生させる可能性**があります。

API をコールするアプリケーションは、  
- リターンコードが返却された取引の通番（`pulSeqNum`）  
- API から返却されたリターンコード値  

を記録することで、ジャーナルから **精査不整合の疑いのある電文を表示**することが可能です。

---

# 4.15. 通番を特定してジャーナル内容を表示する方法

現在の FEXICS 標準コマンドでは、以下の方法でジャーナルの特定レコードを表示できます。

精査不整合の疑いのあるリターンコードを受け取った取引の通番（`pulSeqNum`）が **123** の場合：

```text
[コマンドフォーマット]
fxview_cn j j1_cn.dat /n123
```

上記コマンドを実行することで、**当該電文のすべてのフィールド項目**が表示されます。
